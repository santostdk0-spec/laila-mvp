<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assistente Virtual LAILA</title>
  <!-- TailwindCSS via Play CDN (desenvolvimento rápido) -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <!-- Ionicons para ícones -->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
</head>
<body class="bg-black text-white">

  <!-- Fundo animado de partículas (stars) -->
  <div id="particles-js"></div>

  <!-- Container do chat -->
  <div class="flex flex-col mx-auto my-8 max-w-md bg-black bg-opacity-50 backdrop-blur-lg rounded-xl shadow-xl border border-purple-800 overflow-hidden">
    <!-- Cabeçalho do chat -->
    <header class="py-4 px-6 text-center border-b border-purple-800">
      <h1 class="text-2xl font-bold text-pink-400 neon-text">LAILA</h1>
    </header>
    <!-- Área de mensagens -->
    <main id="chat-messages" class="flex flex-col p-6 h-80 overflow-y-auto space-y-4">
      <!-- As mensagens do usuário e da assistente serão inseridas aqui dinamicamente -->
    </main>
    <!-- Rodapé com input e botões -->
    <footer class="py-4 px-6 border-t border-purple-800 flex items-center space-x-4">
      <!-- Botão de voz -->
      <button id="voice-button" class="text-blue-400 text-2xl focus:outline-none neon-icon">
        <ion-icon name="mic-outline"></ion-icon>
      </button>
      <!-- Campo de entrada de texto -->
      <input id="user-input" type="text" placeholder="Digite sua mensagem..." 
             class="flex-grow px-4 py-2 bg-gray-800 text-white rounded-full focus:outline-none border border-blue-600" />
      <!-- Botão de enviar -->
      <button id="send-button" class="text-green-400 text-2xl focus:outline-none neon-icon">
        <ion-icon name="send-outline"></ion-icon>
      </button>
    </footer>
  </div>

  <!-- Áudio de notificação ao enviar -->
  <audio id="sendSound" src="https://bigsoundbank.com/UPLOAD/mp3/1313.mp3" preload="auto"></audio>

  <!-- Biblioteca de partículas (fundo) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/particlesjs/2.2.3/particles.min.js"></script>
  <!-- Script principal -->
  <script>
    // Configuração das partículas (fundo animado estilo estrelas)
    particlesJS("particles-js", {
      "particles": {
        "number": { "value": 150, "density": { "enable": true, "value_area": 800 } },
        "color": { "value": "#aaaaaa" },
        "shape": { "type": "star" },
        "opacity": { "value": 0.7, "random": true, "anim": { "enable": true, "speed": 0.2, "opacity_min": 0.2 } },
        "size": { "value": 3, "random": true },
        "move": { "enable": true, "speed": 0.3, "direction": "none", "random": true, "straight": false, "out_mode": "out" }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": { "onhover": { "enable": true, "mode": "bubble" }, "onclick": { "enable": true, "mode": "push" } },
        "modes": {
          "bubble": { "distance": 200, "size": 2, "duration": 2, "opacity": 0.8 },
          "push": { "particles_nb": 4 }
        }
      },
      "retina_detect": true
    });

    // Referências a elementos do DOM
    const chatMessages = document.getElementById("chat-messages");
    const userInput = document.getElementById("user-input");
    const sendButton = document.getElementById("send-button");
    const voiceButton = document.getElementById("voice-button");
    const sendSound = document.getElementById("sendSound");

    // Função para adicionar mensagem na tela
    function addMessage(text, fromUser) {
      const msgElem = document.createElement("p");
      // Estilo e alinhamento das bolhas de chat
      if (fromUser) {
        msgElem.className = "bg-blue-900 bg-opacity-80 text-white px-4 py-2 rounded-2xl self-end animate-fadeIn drop-shadow-xl";
      } else {
        msgElem.className = "bg-gray-800 bg-opacity-80 text-white px-4 py-2 rounded-2xl self-start animate-fadeIn drop-shadow-xl";
      }
      msgElem.textContent = text;
      chatMessages.appendChild(msgElem);
      // Scroll para mostrar a mensagem mais recente
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Função de sintese de voz
    function speak(text) {
      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'pt-BR';
        speechSynthesis.speak(utterance);
      }
    }

    // Função para enviar mensagem do usuário
    function sendMessage() {
      const text = userInput.value.trim();
      if (text === "") return;
      // Adiciona mensagem do usuário
      addMessage(text, true);
      // Toca som de envio
      sendSound.currentTime = 0;
      sendSound.play();
      userInput.value = "";
      // Simula resposta da LAILA após 1 segundo (substitua aqui pelo fetch ao seu backend)
      setTimeout(() => {
        const reply = "LAILA: Você disse \"" + text + "\"";
        addMessage(reply, false);
        speak(reply);
      }, 1000);
    }

    // Envia mensagem ao clicar no botão
    sendButton.addEventListener("click", sendMessage);
    // Envia mensagem ao pressionar Enter
    userInput.addEventListener("keyup", function(e) {
      if (e.key === "Enter") sendButton.click();
    });

    // Configuração do reconhecimento de voz
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
      const recognition = new SpeechRecognition();
      recognition.lang = 'pt-BR';
      recognition.continuous = false;
      recognition.interimResults = false;

      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        userInput.value = transcript;
      };
      recognition.onerror = function(event) {
        console.error("Erro no reconhecimento de voz:", event.error);
      };

      // Ativa o reconhecimento de voz ao clicar no botão de microfone
      voiceButton.addEventListener("click", () => {
        recognition.start();
      });
    } else {
      // Oculta ou desabilita o botão se não suportado
      voiceButton.style.display = 'none';
    }
  </script>

  <!-- Estilos adicionais (pode ser colocado em <style> ou separado) -->
  <style>
    /* Animação de fade-in para novas mensagens */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeIn {
      animation: fadeIn 0.5s ease-out;
    }
    /* Efeito neon no texto do cabeçalho */
    .neon-text {
      text-shadow: 0 0 8px #fb07ff, 0 0 16px #fb07ff;
    }
    /* Efeito neon nos ícones (usa a cor corrente do texto) */
    .neon-icon ion-icon {
      filter: drop-shadow(0 0 4px currentColor);
    }
    /* Ajusta z-index do fundo animado para ficar atrás */
    #particles-js {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
    }
  </style>

</body>
</html>
